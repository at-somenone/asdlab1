{"version":3,"sources":["Piece/Piece.module.css","Machine/Machine.module.css","Machine/Machine.ts","Piece/PieceView.tsx","Piece/PieceList.tsx","Machine/MachineView.tsx","Queue/ObservableArrayQueue.ts","Queue/ArrayQueue.ts","Queue/ObservableLinkedListQueue.ts","Queue/LinkedListQueue.ts","App.tsx","index.tsx"],"names":["module","exports","Machine","queue","this","pieces","makeObservable","clear","lastProcessed","undefined","isEmpty","current","peek","timeLeft","dequeue","piece","isFull","keyedPiece","key","uuid","enqueue","observable","contents","action","computed","observer","className","styles","code","PieceList","style","pieceList","map","p","machine","buttonList","onClick","chance","Chance","addPiece","word","length","capitalize","addRandom","progress","dump","reset","ObservableArrayQueue","size","atom","createAtom","item","reportChanged","result","reportObserved","array","head","tail","count","Array","Error","slice","filter","i","ObservableLinkedListQueue","firstNode","lastNode","newNode","next","arr","currentNode","push","state","useLocalObservable","useArrayQueue","type","name","id","checked","onChange","e","target","htmlFor","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e12f46b6.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"pieceList\":\"Piece_pieceList__3QWS1\",\"piece\":\"Piece_piece__3YSQf\",\"code\":\"Piece_code__2Sh0w\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"machine\":\"Machine_machine__Bibia\",\"idkWhatToCallThis\":\"Machine_idkWhatToCallThis__yzbY3\",\"buttonList\":\"Machine_buttonList__30CQA\"};","import { action, computed, makeObservable, observable } from 'mobx'\nimport IQueue from '../Queue/IQueue'\nimport Piece from '../Piece/Piece'\nimport Keyed from '../Keyed'\nimport { v4 as uuid } from 'uuid'\n\nexport default class Machine {\n    @observable private pieces: IQueue<Keyed<Piece>>\n    @observable lastProcessed?: Piece\n\n    constructor(queue: IQueue<Keyed<Piece>>) {\n        this.pieces = queue\n        makeObservable(this)\n    }\n\n    @action reset() {\n        this.pieces.clear()\n        this.lastProcessed = undefined\n    }\n\n    @action progress() {\n        if (this.pieces.isEmpty()) return\n        const current = this.pieces.peek()\n        current.timeLeft -= 1\n        if (current.timeLeft <= 0) this.lastProcessed = this.pieces.dequeue()\n    }\n\n    @action dump() {\n        if (this.pieces.isEmpty()) return\n        this.lastProcessed = this.pieces.dequeue()\n    }\n\n    @action addPiece(piece: Piece) {\n        if (this.isFull) return\n        const keyedPiece = { ...piece, key: uuid() }\n        this.pieces.enqueue(observable(keyedPiece))\n    }\n\n    @computed get anyQueued() {\n        return !this.pieces.isEmpty()\n    }\n\n    @computed get contents() {\n        return this.pieces.contents()\n    }\n\n    @computed get isFull() {\n        return this.pieces.isFull()\n    }\n}\n","import { observer } from 'mobx-react'\nimport Piece from './Piece'\nimport styles from './Piece.module.css'\n\ntype Props = {\n    piece: Piece\n}\n\nconst PieceView = ({ piece }: Props) => (\n    <div className={styles.piece}>\n        <div className={styles.code}>\n            <span>{piece.code}</span>\n        </div>\n        <div className={styles.timeLeft}>\n            <span>{piece.timeLeft}</span>\n        </div>\n    </div>\n)\n\nexport default observer(PieceView)\n","import style from './Piece.module.css'\nimport Keyed from '../Keyed'\nimport Piece from './Piece'\nimport PieceView from './PieceView'\n\ntype Props = {\n    pieces: Keyed<Piece>[]\n}\n\nconst PieceList = ({ pieces }: Props) => (\n    <div className={style.pieceList}>\n        {pieces.map(p => (\n            <PieceView piece={p} key={p.key} />\n        ))}\n    </div>\n)\n\nexport default PieceList\n","import { observer } from 'mobx-react'\nimport styles from './Machine.module.css'\nimport PieceList from '../Piece/PieceList'\nimport Machine from './Machine'\nimport Chance from 'chance'\n\ntype Props = {\n    machine: Machine\n}\n\nconst addRandom = (machine: Machine) => {\n    const chance = new Chance()\n    machine.addPiece({\n        code: chance.word({ length: 4, capitalize: false }),\n        timeLeft: 5,\n    })\n}\n\nconst MachineView = ({ machine }: Props) => (\n    <div className={styles.machine}>\n        <div className={styles.buttonList}>\n            <button onClick={() => addRandom(machine)}>добавить</button>\n            <button onClick={() => machine.progress()}>обработать</button>\n            <button onClick={() => machine.dump()}>снять</button>\n            <button onClick={() => machine.reset()}>сбросить</button>\n        </div>\n\n        <span>\n            Последняя обработанная деталь:{' '}\n            {machine.lastProcessed && (\n                <span>\n                    {machine.lastProcessed.code}{' '}\n                    {machine.lastProcessed.timeLeft > 0 &&\n                        '(снята с обработки)'}{' '}\n                </span>\n            )}\n        </span>\n        <br />\n        <span>Очередь:</span>\n        {machine.contents.length > 0 && <PieceList pieces={machine.contents} />}\n    </div>\n)\n\nexport default observer(MachineView)\n","import { createAtom, IAtom } from 'mobx'\nimport ArrayQueue from './ArrayQueue'\n\nexport default class ObservableArrayQueue<T> extends ArrayQueue<T> {\n    private readonly atom: IAtom\n\n    constructor(size: number) {\n        super(size)\n        this.atom = createAtom('ObservableArrayQueue')\n    }\n\n    enqueue(item: T) {\n        super.enqueue(item)\n        this.atom.reportChanged()\n    }\n\n    dequeue() {\n        const result = super.dequeue()\n        this.atom.reportChanged()\n        return result\n    }\n\n    peek() {\n        this.atom.reportObserved()\n        return super.peek()\n    }\n\n    clear() {\n        this.atom.reportChanged()\n        super.clear()\n    }\n\n    length() {\n        this.atom.reportObserved()\n        return super.length()\n    }\n\n    isFull() {\n        this.atom.reportObserved()\n        return super.isFull()\n    }\n\n    isEmpty() {\n        this.atom.reportObserved()\n        return super.isEmpty()\n    }\n\n    contents() {\n        this.atom.reportObserved()\n        return super.contents()\n    }\n}\n","import IQueue from './IQueue'\n\nexport default class ArrayQueue<T> implements IQueue<T> {\n    private array: (T | undefined)[]\n    private head: number\n    private tail: number\n    private count = 0\n\n    constructor(readonly size: number) {\n        this.array = Array<T>(size + 1)\n        this.head = 0\n        this.tail = 0\n    }\n\n    enqueue(item: T): void {\n        if (this.isFull()) throw new Error('Queue is full')\n        this.array[this.tail] = item\n        this.tail = (this.tail + 1) % (this.size + 1)\n        this.count += 1\n    }\n\n    dequeue(): T {\n        if (this.isEmpty()) throw new Error('Queue is empty')\n        const result = this.peek()\n        this.array[this.head] = undefined\n        this.head = (this.head + 1) % (this.size + 1)\n        this.count -= 1\n\n        return result\n    }\n\n    peek(): T {\n        if (this.isEmpty()) throw new Error('Queue is empty')\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        return this.array[this.head]!\n    }\n\n    clear() {\n        this.count = 0\n        this.array = Array<T>(this.size + 1)\n        this.head = 0\n        this.tail = 0\n    }\n\n    length(): number {\n        return this.count\n    }\n\n    isFull(): boolean {\n        return this.count === this.size\n    }\n\n    isEmpty(): boolean {\n        return this.count === 0\n    }\n\n    contents(): T[] {\n        if (this.tail >= this.head) {\n            return this.array\n                .slice(this.head, this.tail + 1)\n                .filter((i): i is T => i !== undefined)\n        } else\n            return [\n                ...this.array.slice(this.head),\n                ...this.array.slice(0, this.tail),\n            ].filter((i): i is T => i !== undefined)\n    }\n}\n","import { IAtom, createAtom } from 'mobx'\nimport LinkedListQueue from './LinkedListQueue'\n\nexport default class ObservableLinkedListQueue<T> extends LinkedListQueue<T> {\n    private readonly atom: IAtom\n\n    constructor() {\n        super()\n        this.atom = createAtom('ObservableArrayQueue')\n    }\n\n    enqueue(item: T) {\n        super.enqueue(item)\n        this.atom.reportChanged()\n    }\n\n    dequeue() {\n        const result = super.dequeue()\n        this.atom.reportChanged()\n        return result\n    }\n\n    peek() {\n        this.atom.reportObserved()\n        return super.peek()\n    }\n\n    clear() {\n        this.atom.reportChanged()\n        super.clear()\n    }\n\n    length() {\n        this.atom.reportObserved()\n        return super.length()\n    }\n\n    isFull() {\n        this.atom.reportObserved()\n        return super.isFull()\n    }\n\n    isEmpty() {\n        this.atom.reportObserved()\n        return super.isEmpty()\n    }\n\n    contents() {\n        this.atom.reportObserved()\n        return super.contents()\n    }\n}\n","import IQueue from './IQueue'\n\ntype Node<T> = {\n    item: T\n    next?: Node<T>\n}\n\nexport default class LinkedListQueue<T> implements IQueue<T> {\n    private firstNode?: Node<T>\n    private lastNode?: Node<T>\n    private size = 0\n\n    enqueue(item: T): void {\n        const newNode = { item }\n\n        if (!this.firstNode) {\n            this.firstNode = newNode\n            this.lastNode = newNode\n        } else if (!this.firstNode.next) {\n            this.lastNode = newNode\n            this.firstNode.next = this.lastNode\n        } else if (this.lastNode) {\n            this.lastNode.next = newNode\n            this.lastNode = this.lastNode.next\n        }\n\n        this.size += 1\n    }\n\n    dequeue(): T {\n        if (!this.firstNode) throw new Error('Queue is empty')\n        const result = this.firstNode.item\n        if (this.lastNode === this.firstNode) this.lastNode = undefined\n        this.firstNode = this.firstNode.next\n        return result\n    }\n\n    peek(): T {\n        if (!this.firstNode) throw new Error('Queue is empty')\n        return this.firstNode.item\n    }\n\n    clear(): void {\n        this.firstNode = undefined\n        this.lastNode = undefined\n    }\n\n    length(): number {\n        return this.size\n    }\n\n    isFull(): boolean {\n        return false\n    }\n\n    isEmpty(): boolean {\n        return !this.firstNode\n    }\n\n    contents(): T[] {\n        const arr = []\n        let currentNode = this.firstNode\n        while (currentNode) {\n            arr.push(currentNode.item)\n            currentNode = currentNode.next\n        }\n\n        return arr\n    }\n}\n","import { action } from 'mobx'\nimport { observer, useLocalObservable } from 'mobx-react'\nimport Keyed from './Keyed'\nimport Machine from './Machine/Machine'\nimport MachineView from './Machine/MachineView'\nimport Piece from './Piece/Piece'\nimport ObservableArrayQueue from './Queue/ObservableArrayQueue'\nimport ObservableLinkedListQueue from './Queue/ObservableLinkedListQueue'\n\nfunction App() {\n    const state = useLocalObservable(() => ({ useArrayQueue: true }))\n    const queue = state.useArrayQueue\n        ? new ObservableArrayQueue<Keyed<Piece>>(5)\n        : new ObservableLinkedListQueue<Keyed<Piece>>()\n    const machine = new Machine(queue)\n\n    return (\n        <>\n            <input\n                type=\"radio\"\n                name=\"yeah\"\n                id=\"r1\"\n                checked={state.useArrayQueue}\n                onChange={action(e => {\n                    state.useArrayQueue = e.target.checked\n                })}\n            />\n            <label htmlFor=\"r1\">Последовательная</label>\n            <br />\n            <input\n                type=\"radio\"\n                name=\"yeah\"\n                id=\"r2\"\n                checked={!state.useArrayQueue}\n                onChange={action(e => {\n                    state.useArrayQueue = !e.target.checked\n                })}\n            />\n            <label htmlFor=\"r2\">Связная</label>\n            <MachineView machine={machine} />\n        </>\n    )\n}\n\nexport default observer(App)\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n)\n"],"sourceRoot":""}